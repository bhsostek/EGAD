<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>widgets/tabWidget.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="canvasWidget.html">canvasWidget</a><ul class='methods'><li data-type='method'><a href="canvasWidget.html#draw">draw</a></li><li data-type='method'><a href="canvasWidget.html#getCol">getCol</a></li><li data-type='method'><a href="canvasWidget.html#getElement">getElement</a></li><li data-type='method'><a href="canvasWidget.html#getRow">getRow</a></li><li data-type='method'><a href="canvasWidget.html#init">init</a></li><li data-type='method'><a href="canvasWidget.html#postinit">postinit</a></li><li data-type='method'><a href="canvasWidget.html#save">save</a></li><li data-type='method'><a href="canvasWidget.html#setElement">setElement</a></li><li data-type='method'><a href="canvasWidget.html#setFameRate">setFameRate</a></li><li data-type='method'><a href="canvasWidget.html#subscribeToDraw">subscribeToDraw</a></li></ul></li><li><a href="codeEditorWidget.html">codeEditorWidget</a><ul class='methods'><li data-type='method'><a href="codeEditorWidget.html#getCol">getCol</a></li><li data-type='method'><a href="codeEditorWidget.html#getElement">getElement</a></li><li data-type='method'><a href="codeEditorWidget.html#getRow">getRow</a></li><li data-type='method'><a href="codeEditorWidget.html#init">init</a></li><li data-type='method'><a href="codeEditorWidget.html#postinit">postinit</a></li><li data-type='method'><a href="codeEditorWidget.html#save">save</a></li><li data-type='method'><a href="codeEditorWidget.html#setElement">setElement</a></li></ul></li><li><a href="consoleWidget.html">consoleWidget</a><ul class='methods'><li data-type='method'><a href="consoleWidget.html#getCol">getCol</a></li><li data-type='method'><a href="consoleWidget.html#getElement">getElement</a></li><li data-type='method'><a href="consoleWidget.html#getRow">getRow</a></li><li data-type='method'><a href="consoleWidget.html#init">init</a></li><li data-type='method'><a href="consoleWidget.html#log">log</a></li><li data-type='method'><a href="consoleWidget.html#setElement">setElement</a></li><li data-type='method'><a href="consoleWidget.html#subscribe">subscribe</a></li></ul></li><li><a href="FileManager.html">FileManager</a></li><li><a href="Grid.html">Grid</a><ul class='methods'><li data-type='method'><a href="Grid.html#addColumn">addColumn</a></li><li data-type='method'><a href="Grid.html#addDrag">addDrag</a></li><li data-type='method'><a href="Grid.html#addWidget">addWidget</a></li><li data-type='method'><a href="Grid.html#createColumn">createColumn</a></li><li data-type='method'><a href="Grid.html#createDrag">createDrag</a></li><li data-type='method'><a href="Grid.html#createVDrag">createVDrag</a></li><li data-type='method'><a href="Grid.html#executeCallbacks">executeCallbacks</a></li><li data-type='method'><a href="Grid.html#generateSaveObject">generateSaveObject</a></li><li data-type='method'><a href="Grid.html#getCOLUMNS">getCOLUMNS</a></li><li data-type='method'><a href="Grid.html#getHEIGHT">getHEIGHT</a></li><li data-type='method'><a href="Grid.html#getWidget">getWidget</a></li><li data-type='method'><a href="Grid.html#getWIDTH">getWIDTH</a></li><li data-type='method'><a href="Grid.html#init">init</a></li><li data-type='method'><a href="Grid.html#initalize">initalize</a></li><li data-type='method'><a href="Grid.html#initializeWidgit">initializeWidgit</a></li><li data-type='method'><a href="Grid.html#loadGridSizes">loadGridSizes</a></li><li data-type='method'><a href="Grid.html#onDrag">onDrag</a></li><li data-type='method'><a href="Grid.html#onDragEnd">onDragEnd</a></li><li data-type='method'><a href="Grid.html#onVDrag">onVDrag</a></li><li data-type='method'><a href="Grid.html#refresh">refresh</a></li><li data-type='method'><a href="Grid.html#removeWidget">removeWidget</a></li><li data-type='method'><a href="Grid.html#resize">resize</a></li><li data-type='method'><a href="Grid.html#setWidget">setWidget</a></li></ul></li><li><a href="tabWidget.html">tabWidget</a><ul class='methods'><li data-type='method'><a href="tabWidget.html#getCol">getCol</a></li><li data-type='method'><a href="tabWidget.html#getElement">getElement</a></li><li data-type='method'><a href="tabWidget.html#getPath">getPath</a></li><li data-type='method'><a href="tabWidget.html#getRow">getRow</a></li><li data-type='method'><a href="tabWidget.html#init">init</a></li><li data-type='method'><a href="tabWidget.html#openFile">openFile</a></li><li data-type='method'><a href="tabWidget.html#performCallbackForFileType">performCallbackForFileType</a></li><li data-type='method'><a href="tabWidget.html#registerFiletype">registerFiletype</a></li><li data-type='method'><a href="tabWidget.html#resizeTabs">resizeTabs</a></li><li data-type='method'><a href="tabWidget.html#save">save</a></li><li data-type='method'><a href="tabWidget.html#setElement">setElement</a></li></ul></li><li><a href="TransformWidget.html">TransformWidget</a><ul class='methods'><li data-type='method'><a href="TransformWidget.html#getCol">getCol</a></li><li data-type='method'><a href="TransformWidget.html#getElement">getElement</a></li><li data-type='method'><a href="TransformWidget.html#getPosition">getPosition</a></li><li data-type='method'><a href="TransformWidget.html#getRow">getRow</a></li><li data-type='method'><a href="TransformWidget.html#getX">getX</a></li><li data-type='method'><a href="TransformWidget.html#getY">getY</a></li><li data-type='method'><a href="TransformWidget.html#getZ">getZ</a></li><li data-type='method'><a href="TransformWidget.html#init">init</a></li><li data-type='method'><a href="TransformWidget.html#save">save</a></li><li data-type='method'><a href="TransformWidget.html#setElement">setElement</a></li><li data-type='method'><a href="TransformWidget.html#setPosition">setPosition</a></li><li data-type='method'><a href="TransformWidget.html#setScale">setScale</a></li><li data-type='method'><a href="TransformWidget.html#setX">setX</a></li><li data-type='method'><a href="TransformWidget.html#setY">setY</a></li><li data-type='method'><a href="TransformWidget.html#setZ">setZ</a></li><li data-type='method'><a href="TransformWidget.html#syncTransformWithElement">syncTransformWithElement</a></li></ul></li><li><a href="WebviewWidget.html">WebviewWidget</a><ul class='methods'><li data-type='method'><a href="WebviewWidget.html#getCol">getCol</a></li><li data-type='method'><a href="WebviewWidget.html#getElement">getElement</a></li><li data-type='method'><a href="WebviewWidget.html#getRow">getRow</a></li><li data-type='method'><a href="WebviewWidget.html#init">init</a></li><li data-type='method'><a href="WebviewWidget.html#postinit">postinit</a></li><li data-type='method'><a href="WebviewWidget.html#setElement">setElement</a></li></ul></li><li><a href="Widget.html">Widget</a><ul class='methods'><li data-type='method'><a href="Widget.html#getCol">getCol</a></li><li data-type='method'><a href="Widget.html#getElement">getElement</a></li><li data-type='method'><a href="Widget.html#getRow">getRow</a></li><li data-type='method'><a href="Widget.html#init">init</a></li><li data-type='method'><a href="Widget.html#setElement">setElement</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#init">init</a></li><li><a href="global.html#onCloseRequested">onCloseRequested</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">widgets/tabWidget.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const Widget = require('./widget');

let OPEN_TABS = [];
let FILE_TYPES = [];

let tabClass = 'tab'; //CSS class for this tab
let selectedClass = 'selected'; //CSS class for this tab

class tabWidget extends Widget{
    /**
     * @inheritDoc
     * @constructor
     * @augments Widget
     * @param {Integer} x - This is the Column that this widget should be added to.
     * @param {Integer} y - This is the row of of the Column that this widget should be added to.
     * @param {FileTreeWidget} fileTreeWidget - Reference to a FileTree.
     * @returns {canvasWidget} Returns a tabWidget, an instance of the Widget class which creates a new tab every time a file in the file tree is double clicked on.
     */
    constructor(x, y, fileTreeWidget){
        super({
            name:"Canvas",
            col:x,
            row:y
        }, {
            tree:fileTreeWidget
        });

        //Add a subscriber to the passed fileTree
        fileTreeWidget.subscribe((event, data)=>{
            console.log("Event:", event);
            console.log("Data:", data);
            this.openFile(data);
        });
    }

    /** This function overrides the parent widget initialize function and creates a tab bar to be displayed within this widget.
     * @return {Promise&lt;any>}
     */
    async init(){
        return await new Promise((resolve, reject) => {
            this.element = document.createElement('div');
            this.element.setAttribute('id', 'tabs');
            this.element.style.backgroundColor = '#53ffff';
            this.element.style.width = '100%';
            this.element.style.height = '100%';

            resolve(this);
        });
    }


    /**
     * This lets you register a callback to trigger when a file of a specifc type is opened Callback must contain {extension:"the file extension", callback:function()}
     * @param {String} extension - This is the file extension that you want to register a callback for, ie '.png'
     * @param {Function} callback - This is the function you want to execute when a file of type 'extension' is clicked on.
     */
    registerFiletype(extension, callback){
        FILE_TYPES[extension] = {
            extension:extension,
            callback:callback
        }
    }

    /**
     * This function takes a filePath, and adds a new tab to the tab bar, as well as calls the callback function defined for this file type if it is known.
     * @param {String} filePath - The Path to a file to open. Perform the callback function registered for this file type.
     */
    openFile(filePath){
        if(filePath.node.folder){ //Do not open a tab for a folder
            return;
        }
        console.log("Opening:",filePath);
        let pathName = this.getPath(filePath.node);
        this.selectedPath = pathName;
        if(!OPEN_TABS[pathName]) {//Not found
            let tab = document.createElement('div');
            tab.className += ' '+tabClass;
            tab.style.height = '100%';
            tab.style.position = 'absolute';
            tab.innerText = pathName;
            tab.addEventListener("click",() => {
                for(let openTab in OPEN_TABS){
                    OPEN_TABS[openTab].element.classList.remove(selectedClass);
                }
                tab.className += ' '+selectedClass;
                this.performCallbackForFileType(pathName);
            });
            this.element.appendChild(tab);
            OPEN_TABS[pathName] = {
                element:tab,
                filePath:pathName
            };
        }
        for(let openTab in OPEN_TABS){
            OPEN_TABS[openTab].element.classList.remove(selectedClass);
        }
        (OPEN_TABS[pathName].element).className += ' '+selectedClass;
        this.resizeTabs();
        this.performCallbackForFileType(pathName);
    }

    /**
     * Getter for this widgets tab element. Used to append child nodes to the base tab bar element.
     * @return {HTMLElement | *}
     */
    getElement(){
        return this.element;
    }

    /**
     * This function is called whenever this widget is resized, it will automatically set each widget to be the correct size.
     */
    resizeTabs(){
        let index = 0;
        for(let openTab in OPEN_TABS){
            OPEN_TABS[openTab].element.style.width = (100.0 / Object.keys(OPEN_TABS).length) + '%';
            OPEN_TABS[openTab].element.style.left = ((100.0 / Object.keys(OPEN_TABS).length) * index) + '%';
            index++;
        }
    }

    /**
     *  This function determines if any callbacks for the passed file extension are known. If they are known they will be performed.
     * @param {String} title - This is the name of a file. The file extension is stripped from the file.
     */
    performCallbackForFileType(title) {
        if(title.includes(".")){ //This is not a directory
            let extension = title.split('.')[1];
            for(let fileType in FILE_TYPES){
                if(fileType.includes(extension)){
                    //print the file type
                    console.log(title+" is a "+fileType+" file.");
                    //Execute the callback
                    FILE_TYPES[fileType].callback(title);
                }
            }
        }else{
            //is directory
        }
    }

    /**
     * This function is used to get an absolute path for a specific file from a FancyTree node element.
     * @param {FancytreeNode} node - This is a fancy tree node, a path is generated from this call.
     * @return {String} The file path to the root directory of this node.
     */
    getPath(node){
        if(node.parent){
            if(node.parent.title === 'root'){
                return node.title;
            }
            return (this.getPath(node.parent) +'/'+ node.title);
        }else{
            return node.title;
        }
    }

    /**
     * This is simply a wrapper to the parent widget save function.
     * @return {{configData, message}}
     */
    save() {
        return super.save();
    }
}
module.exports = tabWidget;</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Sat Apr 13 2019 16:39:44 GMT-0400 (Eastern Daylight Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
